<div class="journal-index">

  <!-- Month jump nav -->
  {% assign sorted = site.posts | sort: "date" | reverse %}
  {% assign grouped = sorted | group_by_exp: "post", "post.date | date: '%B %Y'" %}
  <div class="journal-month-nav">
    {% for month in grouped %}
      <a href="#{{ month.name | downcase | replace: ' ', '-' }}">{{ month.name }}</a>
    {% endfor %}
  </div>

  <!-- Archive by month -->
  {% for month in grouped %}
    <h2 id="{{ month.name | downcase | replace: ' ', '-' }}" class="journal-month">{{ month.name }}</h2>
    <ul class="journal-list">
      {% for post in month.items %}
        <li class="journal-item">
          <div class="journal-title">
            <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
          </div>
          <div class="journal-meta">
            {{ post.date | date: "%Y-%m-%d" }}
          </div>
          {% if post.excerpt %}
            <div class="journal-excerpt">
              {{ post.excerpt | strip_html | truncate: 160 }}
            </div>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% endfor %}

</div>
